"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[8274],{8274:(j,m,d)=>{d.r(m),d.d(m,{MyRequestsModule:()=>oe});var u=d(177),r=d(2791),y=d(4412),q=d(1594),I=d(5098),e=d(4438),E=d(8600),S=d(7112),R=d(6781),_=d(9417),b=d(1579),T=d(2029),x=d(3955);const k=()=>({width:"50rem"}),l=()=>({height:"4px"}),p=(s,o,t)=>({"badge-light-warning":s,"badge-light-success":o,"badge-light-danger":t}),c=(s,o)=>({"bi-building":s,"bi-person":o}),g=()=>({"background-color":"#EEF6FF",color:"#3E97FF"});function h(s,o){1&s&&e.nrm(0,"p-progressBar",15),2&s&&e.Aen(e.lJ4(2,l))}function F(s,o){1&s&&(e.j41(0,"div",16)(1,"div",17)(2,"div",18)(3,"span",19),e.EFF(4,"Loading..."),e.k0s()(),e.j41(5,"h3",20),e.EFF(6,"Loading Requests"),e.k0s(),e.j41(7,"p",21),e.EFF(8,"Please wait while we fetch your requests..."),e.k0s()()())}function v(s,o){1&s&&(e.j41(0,"div",22)(1,"div",17),e.nrm(2,"img",23),e.j41(3,"h3",20),e.EFF(4,"No Requests Found"),e.k0s(),e.j41(5,"p",21),e.EFF(6,"You don't have any requests at the moment. New requests will appear here once created."),e.k0s()()())}function C(s,o){if(1&s&&(e.j41(0,"div",48),e.nrm(1,"img",56),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.FS9("src",t.requestable.profile_photo_url,e.B4B)}}function M(s,o){if(1&s&&(e.j41(0,"div",48),e.nrm(1,"i",57),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngClass",e.l_i(1,c,"company"===t.requestable_type,"userinsighter"===t.requestable_type))}}function w(s,o){if(1&s&&(e.qex(0),e.EFF(1),e.bVm()),2&s){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.requestable.legal_name," ")}}function D(s,o){if(1&s&&(e.qex(0),e.EFF(1),e.bVm()),2&s){const t=e.XpG().$implicit;e.R7$(),e.Lme(" ",t.requestable.first_name," ",t.requestable.last_name," ")}}function G(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",43)(1,"div",44),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.openRequestDialog(i))}),e.j41(2,"div",45)(3,"div",46)(4,"div",47),e.DNE(5,C,2,1,"div",48)(6,M,2,4),e.j41(7,"div")(8,"div",49),e.DNE(9,w,2,1,"ng-container",50)(10,D,2,2,"ng-container",50),e.k0s()()(),e.j41(11,"div",51)(12,"span",52),e.EFF(13),e.k0s()(),e.j41(14,"div",51)(15,"div",53),e.EFF(16),e.nI1(17,"uppercase"),e.nI1(18,"translate"),e.k0s()(),e.j41(19,"div",47)(20,"button",54),e.bIt("click",function(i){const a=e.eBV(t).$implicit;return e.XpG(3).openRequestDialog(a),e.Njj(i.stopPropagation())}),e.nrm(21,"i",55),e.EFF(22),e.nI1(23,"translate"),e.k0s()()()()()()}if(2&s){const t=o.$implicit;e.R7$(5),e.vxM(5,t.requestable.profile_photo_url?5:6),e.R7$(4),e.Y8G("ngIf","company"===t.requestable_type),e.R7$(),e.Y8G("ngIf","userinsighter"===t.requestable_type),e.R7$(3),e.JRh(t.type.label),e.R7$(2),e.Y8G("ngClass",e.sMw(13,p,"pending"===t.final_status,"approved"===t.final_status,"declined"===t.final_status)),e.R7$(),e.SpI(" ",e.bMT(18,9,"USER_REQUESTS.FILTER."+e.bMT(17,7,t.final_status))," "),e.R7$(6),e.SpI(" ",e.bMT(23,11,"USER_REQUESTS.DIALOG.VIEW")," ")}}function $(s,o){if(1&s&&(e.j41(0,"div",41),e.DNE(1,G,24,17,"div",42),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.filteredUserRequests)}}function N(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",58)(1,"div",59),e.nrm(2,"i",60),e.j41(3,"h4",20),e.EFF(4,"No Matching Requests"),e.k0s(),e.j41(5,"p",21),e.EFF(6,"No requests match your current filter criteria."),e.k0s(),e.j41(7,"button",61),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearUserFilters())}),e.nrm(8,"i",62),e.EFF(9," Clear Filters "),e.k0s()()()}}function U(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",24)(1,"div",25)(2,"h3",26)(3,"span",27),e.EFF(4),e.nI1(5,"translate"),e.k0s()(),e.j41(6,"div",28)(7,"div",29)(8,"div",30)(9,"div",31),e.nrm(10,"i",32),e.EFF(11),e.nI1(12,"translate"),e.k0s(),e.j41(13,"select",33),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.selectedStatus,i)||(a.selectedStatus=i),e.Njj(i)}),e.bIt("change",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.filterRequests())}),e.j41(14,"option",34),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"option",35),e.EFF(18),e.nI1(19,"translate"),e.k0s(),e.j41(20,"option",36),e.EFF(21),e.nI1(22,"translate"),e.k0s(),e.j41(23,"option",37),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()()(),e.j41(26,"div",38),e.DNE(27,$,2,1,"div",39)(28,N,10,0,"div",40),e.nI1(29,"async"),e.k0s()()}if(2&s){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,9,"USER_REQUESTS.TITLE")),e.R7$(7),e.JRh(e.bMT(12,11,"USER_REQUESTS.FILTER.STATUS_TITLE")),e.R7$(2),e.R50("ngModel",t.selectedStatus),e.R7$(2),e.JRh(e.bMT(16,13,"USER_REQUESTS.FILTER.SHOW_ALL")),e.R7$(3),e.JRh(e.bMT(19,15,"USER_REQUESTS.FILTER.PENDING")),e.R7$(3),e.JRh(e.bMT(22,17,"USER_REQUESTS.FILTER.APPROVED")),e.R7$(3),e.JRh(e.bMT(25,19,"USER_REQUESTS.FILTER.REJECTED")),e.R7$(3),e.Y8G("ngIf",t.filteredUserRequests.length>0),e.R7$(),e.Y8G("ngIf",!e.bMT(29,21,t.isLoading$)&&0===t.filteredUserRequests.length&&t.hasUserFilters())}}function L(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",28)(1,"div",29)(2,"div",30)(3,"div",31),e.nrm(4,"i",32),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"select",33),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.selectedInsighterStatus,i)||(a.selectedInsighterStatus=i),e.Njj(i)}),e.bIt("change",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.filterInsighterRequests())}),e.j41(8,"option",34),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"option",35),e.EFF(12),e.nI1(13,"translate"),e.k0s(),e.j41(14,"option",36),e.EFF(15),e.nI1(16,"translate"),e.k0s(),e.j41(17,"option",37),e.EFF(18),e.nI1(19,"translate"),e.k0s()()()()()}if(2&s){const t=e.XpG(2);e.R7$(5),e.JRh(e.bMT(6,6,"INSIGHTER_REQUESTS.FILTER.STATUS")),e.R7$(2),e.R50("ngModel",t.selectedInsighterStatus),e.R7$(2),e.JRh(e.bMT(10,8,"USER_REQUESTS.FILTER.SHOW_ALL")),e.R7$(3),e.JRh(e.bMT(13,10,"USER_REQUESTS.FILTER.PENDING")),e.R7$(3),e.JRh(e.bMT(16,12,"USER_REQUESTS.FILTER.APPROVED")),e.R7$(3),e.JRh(e.bMT(19,14,"USER_REQUESTS.FILTER.REJECTED"))}}function A(s,o){if(1&s&&(e.j41(0,"div",73),e.nrm(1,"img",74),e.k0s()),2&s){const t=e.XpG(2).$implicit;e.R7$(),e.Y8G("src",t.requestable.profile_photo_url,e.B4B)}}function B(s,o){if(1&s&&(e.j41(0,"div",75),e.EFF(1),e.nI1(2,"slice"),e.nI1(3,"slice"),e.k0s()),2&s){const t=e.XpG(2).$implicit;e.Y8G("ngStyle",e.lJ4(11,g)),e.R7$(),e.Lme(" ",e.brH(2,3,t.requestable.name,0,1),"",e.brH(3,7,t.requestable.name&&t.requestable.name.indexOf(" ")>-1?t.requestable.name.split(" ")[1]:"",0,1)," ")}}function V(s,o){if(1&s&&(e.j41(0,"div",70),e.DNE(1,A,2,1,"div",71)(2,B,4,12,"div",72),e.k0s()),2&s){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.requestable.profile_photo_url),e.R7$(),e.Y8G("ngIf",!t.requestable.profile_photo_url&&t.requestable.name)}}function Y(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",43)(1,"div",44),e.bIt("click",function(){const i=e.eBV(t).$implicit,a=e.XpG(3);return e.Njj(a.openInsighterRequestDialog(i))}),e.j41(2,"div",45)(3,"div",46)(4,"div",47),e.DNE(5,V,3,2,"div",66),e.j41(6,"div")(7,"div",67),e.EFF(8),e.k0s(),e.j41(9,"div",68),e.EFF(10),e.k0s()()(),e.j41(11,"div",51)(12,"span",52),e.EFF(13),e.k0s()(),e.j41(14,"div",51)(15,"div",53),e.EFF(16),e.nI1(17,"uppercase"),e.nI1(18,"translate"),e.k0s()(),e.j41(19,"div",69)(20,"button",54),e.bIt("click",function(i){const a=e.eBV(t).$implicit;return e.XpG(3).openInsighterRequestDialog(a),e.Njj(i.stopPropagation())}),e.nrm(21,"i",55),e.EFF(22),e.nI1(23,"translate"),e.k0s()()()()()()}if(2&s){const t=o.$implicit;e.R7$(5),e.Y8G("ngIf",t.requestable),e.R7$(3),e.JRh(t.requestable.name||"Unknown"),e.R7$(2),e.JRh(t.comments||"No comments"),e.R7$(3),e.JRh(t.type.label),e.R7$(2),e.Y8G("ngClass",e.sMw(13,p,"pending"===t.final_status,"approved"===t.final_status,"declined"===t.final_status)),e.R7$(),e.SpI(" ",e.bMT(18,9,"USER_REQUESTS.STATUS."+e.bMT(17,7,t.final_status))," "),e.R7$(6),e.SpI(" ",e.bMT(23,11,"USER_REQUESTS.DIALOG.VIEW")," ")}}function P(s,o){if(1&s&&(e.j41(0,"div",41),e.DNE(1,Y,24,17,"div",42),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.filteredInsighterRequests)}}function X(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",58)(1,"div",59),e.nrm(2,"i",60),e.j41(3,"h4",20),e.EFF(4,"No Matching Requests"),e.k0s(),e.j41(5,"p",21),e.EFF(6,"No insighter requests match your current filter criteria."),e.k0s(),e.j41(7,"button",76),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.clearInsighterFilters())}),e.nrm(8,"i",62),e.EFF(9," Clear Filters "),e.k0s()()()}}function O(s,o){if(1&s&&(e.j41(0,"div",63)(1,"div",25)(2,"h3",26)(3,"span",27),e.EFF(4),e.nI1(5,"translate"),e.k0s(),e.nrm(6,"span",64),e.k0s(),e.DNE(7,L,20,16,"div",65),e.k0s(),e.j41(8,"div",38),e.DNE(9,P,2,1,"div",39)(10,X,10,0,"div",40),e.nI1(11,"async"),e.k0s()()),2&s){const t=e.XpG();e.R7$(4),e.JRh(e.bMT(5,4,"INSIGHTER_REQUESTS.TITLE")),e.R7$(3),e.Y8G("ngIf",t.insighterRequests.length>0),e.R7$(2),e.Y8G("ngIf",t.filteredInsighterRequests.length>0),e.R7$(),e.Y8G("ngIf",!e.bMT(11,6,t.isLoading$)&&0===t.filteredInsighterRequests.length&&t.hasInsighterFilters())}}function Q(s,o){if(1&s&&(e.j41(0,"div",83)(1,"h6",84),e.nrm(2,"i",85),e.EFF(3),e.nI1(4,"translate"),e.k0s(),e.j41(5,"div",86)(6,"p",87),e.EFF(7),e.nI1(8,"translate"),e.k0s()()()),2&s){const t=e.XpG(2);e.R7$(3),e.SpI(" ",e.bMT(4,2,"USER_REQUESTS.DIALOG.STAFF_NOTES_LABEL")," "),e.R7$(4),e.SpI(" ",t.selectedRequest.staff_notes||e.bMT(8,4,"USER_REQUESTS.DIALOG.NO_STAFF_NOTES")," ")}}function J(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",91)(1,"button",92),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.navigateToReview())}),e.nrm(2,"i",93),e.EFF(3," Review Knowledge "),e.k0s()()}}function H(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",94)(1,"button",95),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.onApproveRequest())}),e.nrm(2,"i",96),e.EFF(3," Approve "),e.k0s(),e.j41(4,"button",97),e.bIt("click",function(){e.eBV(t);const i=e.XpG(3);return e.Njj(i.onDeclineRequest())}),e.nrm(5,"i",98),e.EFF(6," Decline "),e.k0s()()}}function z(s,o){if(1&s&&(e.j41(0,"div",88),e.DNE(1,J,4,0,"div",89)(2,H,7,0,"div",90),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf","accept_knowledge"===(null==t.selectedRequest.type?null:t.selectedRequest.type.key)&&t.selectedRequest.knowledge_id),e.R7$(),e.Y8G("ngIf",!(null!=t.selectedRequest.type&&t.selectedRequest.type.key)||"accept_knowledge"!==(null==t.selectedRequest.type?null:t.selectedRequest.type.key))}}function K(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",99)(1,"div",100)(2,"h5",101),e.nrm(3,"i",102),e.EFF(4," Staff Notes "),e.k0s()(),e.j41(5,"div",103)(6,"textarea",104),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG(2);return e.DH7(a.staffNotes,i)||(a.staffNotes=i),e.Njj(i)}),e.k0s()(),e.j41(7,"div",105)(8,"div",106)(9,"button",107),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.confirmAction())}),e.nrm(10,"i",108),e.EFF(11),e.k0s(),e.j41(12,"button",109),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.cancelAction())}),e.nrm(13,"i",110),e.EFF(14),e.nI1(15,"translate"),e.k0s()()()()}if(2&s){const t=e.XpG(2);e.R7$(6),e.R50("ngModel",t.staffNotes),e.R7$(3),e.HbH(t.isApproving?"btn btn-success  flex-grow-1":"btn btn-danger  flex-grow-1"),e.Y8G("disabled",!t.staffNotes),e.R7$(),e.Y8G("ngClass",t.isApproving?"bi-check-lg":"bi-x-lg"),e.R7$(),e.SpI(" ",t.isApproving?"Confirm Approval":"Confirm Decline"," "),e.R7$(3),e.SpI(" ",e.bMT(15,7,"CANCEL")," ")}}function W(s,o){if(1&s&&(e.j41(0,"div",77)(1,"h3",78),e.EFF(2),e.k0s(),e.j41(3,"div",78)(4,"div",79),e.EFF(5),e.nI1(6,"titlecase"),e.k0s()(),e.DNE(7,Q,9,6,"div",80)(8,z,3,2,"div",81)(9,K,16,9,"div",82),e.k0s()),2&s){const t=e.XpG();e.R7$(2),e.JRh(t.selectedRequest.type.label),e.R7$(2),e.Y8G("ngClass",e.sMw(8,p,"pending"===t.selectedRequest.final_status,"approved"===t.selectedRequest.final_status,"declined"===t.selectedRequest.final_status)),e.R7$(),e.SpI(" ",e.bMT(6,6,t.selectedRequest.final_status)," "),e.R7$(2),e.Y8G("ngIf","pending"!==t.selectedRequest.final_status),e.R7$(),e.Y8G("ngIf","pending"===t.selectedRequest.final_status&&t.isInsighterRequest),e.R7$(),e.Y8G("ngIf","pending"===t.selectedRequest.final_status&&t.isInsighterRequest&&(t.isApproving||t.isDeclining))}}function Z(s,o){if(1&s){const t=e.RV6();e.qex(0),e.j41(1,"button",114),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.viewKnowledge())}),e.EFF(2," View Knowledge "),e.k0s(),e.bVm()}}function ee(s,o){if(1&s){const t=e.RV6();e.j41(0,"div",111)(1,"div",100)(2,"h5",101),e.EFF(3),e.nI1(4,"translate"),e.k0s()(),e.j41(5,"div",103)(6,"textarea",112),e.mxI("ngModelChange",function(i){e.eBV(t);const a=e.XpG();return e.DH7(a.resendComments,i)||(a.resendComments=i),e.Njj(i)}),e.k0s()(),e.j41(7,"div",105)(8,"button",113),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onResendRequest())}),e.EFF(9," Resend Request "),e.k0s(),e.DNE(10,Z,3,0,"ng-container",50),e.k0s()()}if(2&s){const t=e.XpG();e.R7$(3),e.SpI(" ",e.bMT(4,4,"USER_REQUESTS.DIALOG.RESEND_REQUEST")," "),e.R7$(3),e.R50("ngModel",t.resendComments),e.R7$(2),e.Y8G("disabled",!t.resendComments),e.R7$(2),e.Y8G("ngIf","accept_knowledge"===(null==t.selectedRequest||null==t.selectedRequest.type?null:t.selectedRequest.type.key)&&(null==t.selectedRequest?null:t.selectedRequest.identity))}}function te(s,o){1&s&&(e.j41(0,"div",115)(1,"div",47),e.nrm(2,"i",116),e.j41(3,"span"),e.EFF(4),e.nI1(5,"translate"),e.k0s()()()),2&s&&(e.R7$(4),e.JRh(e.bMT(5,1,"USER_REQUESTS.DIALOG.PENDING_REQUEST_EXISTS")))}let se=(()=>{class s extends I.${userRequestsService;getProfileService;router;userRequests=[];filteredUserRequests=[];insighterRequests=[];filteredInsighterRequests=[];isLoading$;loadingSubject=new y.t(!0);selectedType="";selectedStatus="";selectedInsighterType="";selectedInsighterStatus="";resendComments="";displayRequestDialog=!1;selectedRequest=null;userProfile=null;hasPendingRequestOfSameType=!1;profileLoaded=!1;userRequestsLoaded=!1;insighterRequestsLoaded=!1;isInsighterRequest=!1;isApproving=!1;isDeclining=!1;staffNotes="";constructor(t,n,i,a){super(t),this.userRequestsService=n,this.getProfileService=i,this.router=a,this.isLoading$=this.loadingSubject.asObservable()}ngOnInit(){this.loadingSubject.next(!0),this.loadData(),this.getProfile()}getProfile(){this.getProfileService.getProfile().pipe((0,q.$)()).subscribe({next:t=>{console.log("User profile loaded:",t),console.log("User roles:",t?.roles),this.userProfile=t,this.profileLoaded=!0,t?.roles.includes("company")?this.loadInsighterRequests():(this.insighterRequestsLoaded=!0,this.checkLoadingComplete())},error:t=>{console.error("Error loading profile:",t),this.profileLoaded=!0,this.checkLoadingComplete()}})}loadData(){this.userRequestsService.getAllUserRequests(this.lang).subscribe({next:t=>{this.userRequests=t,this.filterRequests(),this.userRequestsLoaded=!0,this.checkLoadingComplete()},error:t=>{console.error("Error loading user requests:",t),this.userRequestsLoaded=!0,this.checkLoadingComplete()}})}loadInsighterRequests(){console.log("Loading insighter requests..."),this.userRequestsService.getInsighterRequests(this.lang).subscribe({next:t=>{console.log("Insighter requests loaded:",t),this.insighterRequests=t,this.filterInsighterRequests(),this.insighterRequestsLoaded=!0,this.checkLoadingComplete()},error:t=>{console.error("Error loading insighter requests:",t),this.insighterRequestsLoaded=!0,this.checkLoadingComplete()}})}checkLoadingComplete(){this.profileLoaded&&this.userRequestsLoaded&&this.insighterRequestsLoaded&&this.loadingSubject.next(!1)}filterRequests(){this.filteredUserRequests=this.userRequests.filter(t=>!(this.selectedType&&t.type.key!==this.selectedType||this.selectedStatus&&t.final_status!==this.selectedStatus))}filterInsighterRequests(){console.log("Filtering insighter requests. Total count:",this.insighterRequests.length),console.log("Current filters - Type:",this.selectedInsighterType,"Status:",this.selectedInsighterStatus),this.filteredInsighterRequests=this.insighterRequests.filter(t=>!(this.selectedInsighterType&&t.type.key!==this.selectedInsighterType||this.selectedInsighterStatus&&t.final_status!==this.selectedInsighterStatus)),console.log("Filtered insighter requests count:",this.filteredInsighterRequests.length)}hasActiveFilters(){return this.hasUserFilters()||this.hasInsighterFilters()}hasUserFilters(){return!!this.selectedType||!!this.selectedStatus}hasInsighterFilters(){return!!this.selectedInsighterType||!!this.selectedInsighterStatus}clearUserFilters(){this.selectedType="",this.selectedStatus="",this.filterRequests()}clearInsighterFilters(){this.selectedInsighterType="",this.selectedInsighterStatus="",this.filterInsighterRequests()}openRequestDialog(t){const n=this.getLatestChild(t);this.selectedRequest=n,this.isInsighterRequest=!1,this.hasPendingRequestOfSameType=this.userRequests.some(i=>i.type.key===n.type.key&&"pending"===i.final_status&&i.id!==n.id),this.displayRequestDialog=!0}openInsighterRequestDialog(t){const n=this.getLatestChild(t);if("accept_knowledge"===n.type?.key&&n.identity)return this.selectedRequest=n,void this.navigateToReview();this.selectedRequest=n,this.isInsighterRequest=!0,this.isApproving=!1,this.isDeclining=!1,this.staffNotes="",this.hasPendingRequestOfSameType=this.insighterRequests.some(i=>i.type.key===n.type.key&&"pending"===i.final_status&&i.id!==n.id),this.displayRequestDialog=!0}onApproveRequest(){this.isApproving=!0,this.isDeclining=!1}onDeclineRequest(){this.isApproving=!1,this.isDeclining=!0}cancelAction(){this.isApproving=!1,this.isDeclining=!1,this.staffNotes=""}confirmAction(){!this.selectedRequest||!this.staffNotes.trim()||(this.isApproving?this.approveInsighterRequest():this.isDeclining&&this.declineInsighterRequest())}approveInsighterRequest(){if(!this.selectedRequest||!this.staffNotes.trim())return;const t=this.selectedRequest.id.toString();this.loadingSubject.next(!0),this.userRequestsService.updateInsighterRequestStatus(t,"approved",this.staffNotes).subscribe({next:()=>{this.showSuccess("Success","Request approved successfully"),this.displayRequestDialog=!1,this.userProfile?.roles.includes("company")?this.loadInsighterRequests():this.loadData(),this.resetActionState()},error:i=>{console.error("Error approving request:",i),this.showError("Error","Failed to approve request"),this.loadingSubject.next(!1)}})}declineInsighterRequest(){if(!this.selectedRequest||!this.staffNotes.trim())return;const t=this.selectedRequest.id.toString();this.loadingSubject.next(!0),this.userRequestsService.updateInsighterRequestStatus(t,"declined",this.staffNotes).subscribe({next:()=>{this.showSuccess("Success","Request declined successfully"),this.displayRequestDialog=!1,this.userProfile?.roles.includes("company")?this.loadInsighterRequests():this.loadData(),this.resetActionState()},error:i=>{console.error("Error declining request:",i),this.showError("Error","Failed to decline request"),this.loadingSubject.next(!1)}})}resetActionState(){this.isApproving=!1,this.isDeclining=!1,this.staffNotes="",this.selectedRequest=null}viewFilteredStock(){}getLatestChild(t){let n=t;if(t.children&&t.children.length>0)for(const i of t.children){const a=this.getLatestChild(i);a.id>n.id&&(n=a)}return n}onResendRequest(){if(this.selectedRequest?.id&&this.resendComments.trim())if(this.loadingSubject.next(!0),"activate_company"===this.selectedRequest.type.key){const t=this.userRequestsService.sendActivationRequest(this.resendComments,this.selectedRequest.id.toString()).subscribe({next:()=>{this.showSuccess("Success","Verification request resent successfully."),this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{console.error("Error resending verification request:",n),this.showError("Error","Failed to resend verification request."),this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}else if("verified_company"===this.selectedRequest?.type.key){const t=this.userRequestsService.sendVerificationRequest(this.resendComments,this.selectedRequest.id.toString()).subscribe({next:()=>{this.showSuccess("Success","Activation request resent successfully."),this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{console.error("Error resending activation request:",n),this.showError("Error","Failed to resend activation request."),this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}else if("deactivate_delete_company"===this.selectedRequest?.type.key){const t=this.userRequestsService.sendDeactivateAndDeleteRequest(this.resendComments,this.selectedRequest.id.toString()).subscribe({next:()=>{this.showSuccess("Success","Deactivation request sent successfully."),this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}else if("deactivate_delete_insighter"===this.selectedRequest?.type.key){const t=this.userRequestsService.sendDeactivateAndDeleteRequestInsighter(this.resendComments,this.selectedRequest.id.toString()).subscribe({next:()=>{this.showSuccess("Success","Deactivation request sent successfully."),this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}else if("accept_knowledge"===this.selectedRequest?.type.key&&this.selectedRequest.identity){const t=this.userRequestsService.sendKnowledgeReviewRequest(this.resendComments,this.selectedRequest.id.toString(),this.selectedRequest.identity).subscribe({next:()=>{this.showSuccess("Success","Knowledge review request sent successfully."),this.loadData(),this.userProfile?.roles.includes("company")?this.loadInsighterRequests():this.loadData(),this.displayRequestDialog=!1,this.resendComments=""},error:n=>{console.error("Error sending knowledge review request:",n),this.showError("Error","Failed to send knowledge review request."),this.loadingSubject.next(!1)}});this.unsubscribe.push(t)}}navigateToReview(){this.selectedRequest?.identity&&(this.router.navigate(["/app/review-insighter-knowledge/review",this.selectedRequest.identity],{queryParams:{requestId:this.selectedRequest.id}}),this.displayRequestDialog=!1)}viewKnowledge(){this.selectedRequest?.identity&&(this.router.navigate(["/app/my-knowledge-base/view-my-knowledge/",parseInt(this.selectedRequest.identity),"details"]),this.displayRequestDialog=!1)}getRequestsSubtitle(){return"ar"===this.lang?"\u0647\u0646\u0627 \u064a\u0645\u0643\u0646\u0643 \u0645\u062a\u0627\u0628\u0639\u0629 \u062d\u0627\u0644\u0629 \u0637\u0644\u0628\u0627\u062a\u0643 \u0639\u0644\u0649 \u0627\u0644\u0645\u0646\u0635\u0629.":"Review the status of your platform requests here."}static \u0275fac=function(n){return new(n||s)(e.rXU(e.zZn),e.rXU(E.J),e.rXU(S.p),e.rXU(r.Ix))};static \u0275cmp=e.VBU({type:s,selectors:[["app-my-requests"]],features:[e.Vt3],decls:21,vars:31,consts:[[3,"titleEn","titleAr","subtitle","lang"],["slot","icon",2,"display","flex","align-items","center","justify-content","center"],[1,"ki-duotone","ki-question-2","fs-2x","text-info"],[1,"path1"],[1,"path2"],[1,"path3"],["mode","indeterminate","styleClass","",3,"style",4,"ngIf"],["class","text-center py-10 bg-light rounded mb-5 border border-1 border-light",4,"ngIf"],["class","text-center py-10 bg-light-secondary rounded mb-5 border border-1 border-light",4,"ngIf"],["class","mb-5  card",4,"ngIf"],["class","mb-5 mb-xl-10 card",4,"ngIf"],["appendTo","body",3,"visibleChange","header","visible","modal","closable"],["class","d-flex flex-column align-items-center",4,"ngIf"],["class","mt-5 w-100",4,"ngIf"],["class","mt-4 alert alert-warning  border",4,"ngIf"],["mode","indeterminate","styleClass",""],[1,"text-center","py-10","bg-light","rounded","mb-5","border","border-1","border-light"],[1,"my-5"],["role","status",1,"spinner-border","text-primary","mb-4",2,"width","3rem","height","3rem"],[1,"visually-hidden"],[1,"fw-bold","text-gray-800","mb-2"],[1,"text-gray-600","fs-6","px-3"],[1,"text-center","py-10","bg-light-secondary","rounded","mb-5","border","border-1","border-light"],["src","assets/media/illustrations/dozzy-1/7117863_3369471.svg","alt","No Requests Illustration",1,"mb-4",2,"max-width","300px"],[1,"mb-5","card"],[1,"card-header","pt-7","border-0"],[1,"card-title","align-items-start","flex-column"],[1,"fw-bolder","text-dark"],[1,"card-toolbar"],[1,"d-flex","justify-content-end","flex-wrap","gap-4"],[1,"d-flex","align-items-center","fw-bold"],[1,"text-muted","fs-7","mx-2"],[1,"bi","bi-check-circle","mx-1"],[1,"form-select","form-select-sm","form-select-solid","text-gray-800","fs-7","lh-1","fw-bold","py-1","ps-3","w-auto",3,"ngModelChange","change","ngModel"],["value",""],["value","pending"],["value","approved"],["value","rejected"],[1,"card-body","pt-6","pb-4"],["class","row g-3",4,"ngIf"],["class","text-center py-8 bg-light-secondary rounded",4,"ngIf"],[1,"row","g-3"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],[1,"card","card-bordered","hover-elevate-up","cursor-pointer",3,"click"],[1,"card-body","py-3","px-4"],[1,"d-flex","align-items-center","justify-content-between"],[1,"d-flex","align-items-center"],[1,"symbol","symbol-40px","me-4","h-40px","w-40px","bg-light-info","d-flex","align-items-center","justify-content-center","rounded-circle"],[1,"fs-5","fw-bold","d-flex","align-items-center"],[4,"ngIf"],[1,"d-none","d-md-flex","align-items-center","mx-4"],[1,"badge","badge-light-info","fs-7","fw-bold"],[1,"badge","badge-pill",3,"ngClass"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"bi","bi-eye-fill","mx-1"],["alt","User Image",1,"h-100","w-100","rounded-circle",2,"object-fit","cover","object-position","top",3,"src"],[1,"bi","fs-4",3,"ngClass"],[1,"text-center","py-8","bg-light-secondary","rounded"],[1,"my-3"],[1,"bi","bi-funnel","fs-1","text-gray-400","mb-3","d-block"],[1,"btn","btn-sm","btn-light-info","mt-2",3,"click"],[1,"bi","bi-x-circle","me-1"],[1,"mb-5","mb-xl-10","card"],[1,"text-muted","mt-1","fw-semibold","fs-6"],["class","card-toolbar",4,"ngIf"],["class","me-4",4,"ngIf"],[1,"fs-5","fw-bold"],[1,"text-muted","fs-7"],[1,"d-flex","flex-shrink-0"],[1,"me-4"],["class","symbol symbol-40px w-40px h-40px overflow-hidden rounded-circle",4,"ngIf"],["class","symbol symbol-40px d-flex align-items-center h-40px w-40px justify-content-center rounded-circle",3,"ngStyle",4,"ngIf"],[1,"symbol","symbol-40px","w-40px","h-40px","overflow-hidden","rounded-circle"],["alt","Profile",1,"w-100","object-fit-cover",2,"object-position","top",3,"src"],[1,"symbol","symbol-40px","d-flex","align-items-center","h-40px","w-40px","justify-content-center","rounded-circle",3,"ngStyle"],[1,"btn","btn-sm","btn-light-primary","mt-2",3,"click"],[1,"d-flex","flex-column","align-items-center"],[1,"mb-4"],[1,"badge",3,"ngClass"],["class","w-100 mb-4",4,"ngIf"],["class","w-100 mt-3",4,"ngIf"],["class","w-100 mt-5",4,"ngIf"],[1,"w-100","mb-4"],[1,"fw-bold","mb-2"],[1,"bi","bi-chat-left-text","me-2"],[1,"bg-light-secondary","rounded","p-4"],[1,"text-gray-700","mb-0"],[1,"w-100","mt-3"],["class","text-center",4,"ngIf"],["class","d-flex gap-3 justify-content-center",4,"ngIf"],[1,"text-center"],["type","button",1,"btn","btn-primary","btn-lg","btn-icon-primary","w-75","mb-2",3,"click"],[1,"bi","bi-file-earmark-text","fs-4","mx-2"],[1,"d-flex","gap-3","justify-content-center"],["type","button",1,"btn","btn-light-success","btn-lg","px-6","py-3",3,"click"],[1,"bi","bi-check-circle-fill","fs-4","mx-2"],["type","button",1,"btn","btn-light-danger","btn-lg","px-6","py-3",3,"click"],[1,"bi","bi-x-circle-fill","fs-4","mx-2"],[1,"w-100","mt-5"],[1,"card-header","border-0","ps-0","pt-0"],[1,"card-title","fw-semibold","text-dark"],[1,"bi","bi-pencil-square","mx-2"],[1,"card-body","px-0"],["id","staffNotes","rows","4","placeholder","Enter your notes here...",1,"form-control","border-1",3,"ngModelChange","ngModel"],[1,"card-footer","border-0","px-0","pt-4","bg-transparent"],[1,"d-flex","gap-3"],["type","button",3,"click","disabled"],[1,"bi","fs-6","mx-2",3,"ngClass"],["type","button",1,"btn","btn-light","btn-active-light-secondary",3,"click"],[1,"bi","bi-arrow-left","fs-6","mx-2"],[1,"mt-5","w-100"],["id","resendComments","rows","4","placeholder","Please explain why you are resending this request...",1,"form-control","border-1",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-primary","btn-icon-primary","w-100",3,"click","disabled"],["type","button",1,"btn","btn-primary","btn-icon-primary","w-100","mt-4",3,"click"],[1,"mt-4","alert","alert-warning","border"],[1,"bi","bi-exclamation-triangle-fill","mx-2","fs-4","text-warning"]],template:function(n,i){1&n&&(e.j41(0,"app-page-header",0)(1,"div",1)(2,"i",2),e.nrm(3,"span",3)(4,"span",4)(5,"span",5),e.k0s()()(),e.DNE(6,h,1,3,"p-progressBar",6),e.nI1(7,"async"),e.DNE(8,F,9,0,"div",7),e.nI1(9,"async"),e.DNE(10,v,7,0,"div",8),e.nI1(11,"async"),e.DNE(12,U,30,23,"div",9),e.nI1(13,"async"),e.DNE(14,O,12,8,"div",10),e.nI1(15,"async"),e.j41(16,"p-dialog",11),e.nI1(17,"translate"),e.mxI("visibleChange",function(f){return e.DH7(i.displayRequestDialog,f)||(i.displayRequestDialog=f),f}),e.DNE(18,W,10,12,"div",12)(19,ee,11,6,"div",13)(20,te,6,3,"div",14),e.k0s()),2&n&&(e.Y8G("titleEn","My Requests")("titleAr","\u0637\u0644\u0628\u0627\u062a\u064a")("subtitle",i.getRequestsSubtitle())("lang",i.lang),e.R7$(6),e.Y8G("ngIf",e.bMT(7,18,i.isLoading$)),e.R7$(2),e.Y8G("ngIf",e.bMT(9,20,i.isLoading$)),e.R7$(2),e.Y8G("ngIf",!e.bMT(11,22,i.isLoading$)&&0===i.filteredUserRequests.length&&0===i.filteredInsighterRequests.length&&!i.hasActiveFilters()),e.R7$(2),e.Y8G("ngIf",!e.bMT(13,24,i.isLoading$)&&i.userProfile&&i.userRequests.length>0),e.R7$(2),e.Y8G("ngIf",!e.bMT(15,26,i.isLoading$)&&i.insighterRequests.length>0),e.R7$(2),e.Aen(e.lJ4(30,k)),e.FS9("header",e.bMT(17,28,"USER_REQUESTS.DIALOG.HEADER")),e.R50("visible",i.displayRequestDialog),e.Y8G("modal",!0)("closable",!0),e.R7$(2),e.Y8G("ngIf",i.selectedRequest),e.R7$(),e.Y8G("ngIf","declined"===(null==i.selectedRequest?null:i.selectedRequest.final_status)&&!i.hasPendingRequestOfSameType&&!i.isInsighterRequest),e.R7$(),e.Y8G("ngIf",i.hasPendingRequestOfSameType&&"approved"!==(null==i.selectedRequest?null:i.selectedRequest.final_status)))},dependencies:[u.YU,u.Sq,u.bT,u.B3,R.l,_.xH,_.y7,_.me,_.wz,_.BC,_.vS,b.z,T.y,u.Jj,u.Pc,u.P9,u.PV,x.D9]})}return s})();var ie=d(4133),ne=d(3354);const re=[{path:"",component:se}];let oe=(()=>{class s{static \u0275fac=function(n){return new(n||s)};static \u0275mod=e.$C({type:s});static \u0275inj=e.G2t({imports:[u.MD,r.iI.forChild(re),ie.E,R.P,_.YN,b.d,ne.f]})}return s})()},1579:(j,m,d)=>{d.d(m,{d:()=>k,z:()=>x});var u=d(177),r=d(4438),y=d(5779);const q=(l,p)=>({"p-progressbar p-component":!0,"p-progressbar-determinate":l,"p-progressbar-indeterminate":p}),I=(l,p)=>({width:l,display:"flex",background:p}),e=l=>({$implicit:l}),E=l=>({display:l}),S=l=>({background:l});function R(l,p){if(1&l&&(r.j41(0,"div",7),r.EFF(1),r.k0s()),2&l){const c=r.XpG(2);r.Y8G("ngStyle",r.eq3(4,E,null!=c.value&&0!==c.value?"flex":"none")),r.BMQ("data-pc-section","label"),r.R7$(),r.Lme(" ",c.value,"",c.unit," ")}}function _(l,p){1&l&&r.eu8(0)}function b(l,p){if(1&l&&(r.j41(0,"div",3)(1,"div",4),r.DNE(2,R,2,6,"div",5)(3,_,1,0,"ng-container",6),r.k0s()()),2&l){const c=r.XpG();r.Y8G("ngStyle",r.l_i(5,I,c.value+"%",c.color)),r.BMQ("data-pc-section","value"),r.R7$(2),r.Y8G("ngIf",c.showValue&&!c.contentTemplate),r.R7$(),r.Y8G("ngTemplateOutlet",c.contentTemplate)("ngTemplateOutletContext",r.eq3(8,e,c.value))}}function T(l,p){if(1&l&&(r.j41(0,"div",8),r.nrm(1,"div",3),r.k0s()),2&l){const c=r.XpG();r.BMQ("data-pc-section","container"),r.R7$(),r.Y8G("ngStyle",r.eq3(3,S,c.color)),r.BMQ("data-pc-section","value")}}let x=(()=>{class l{value;showValue=!0;styleClass;style;unit="%";mode="determinate";color;templates;contentTemplate;ngAfterContentInit(){this.templates?.forEach(c=>{c.getType(),this.contentTemplate=c.template})}static \u0275fac=function(g){return new(g||l)};static \u0275cmp=r.VBU({type:l,selectors:[["p-progressBar"]],contentQueries:function(g,h,F){if(1&g&&r.wni(F,y.Ei,4),2&g){let v;r.mGM(v=r.lsd())&&(h.templates=v)}},hostAttrs:[1,"p-element"],inputs:{value:[r.Mj6.HasDecoratorInputTransform,"value","value",r.Udg],showValue:[r.Mj6.HasDecoratorInputTransform,"showValue","showValue",r.L39],styleClass:"styleClass",style:"style",unit:"unit",mode:"mode",color:"color"},features:[r.GFd],decls:3,vars:14,consts:[["role","progressbar",3,"ngStyle","ngClass"],["class","p-progressbar-value p-progressbar-value-animate",3,"ngStyle",4,"ngIf"],["class","p-progressbar-indeterminate-container",4,"ngIf"],[1,"p-progressbar-value","p-progressbar-value-animate",3,"ngStyle"],[1,"p-progressbar-label"],[3,"ngStyle",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngStyle"],[1,"p-progressbar-indeterminate-container"]],template:function(g,h){1&g&&(r.j41(0,"div",0),r.DNE(1,b,4,10,"div",1)(2,T,2,5,"div",2),r.k0s()),2&g&&(r.HbH(h.styleClass),r.Y8G("ngStyle",h.style)("ngClass",r.l_i(11,q,"determinate"===h.mode,"indeterminate"===h.mode)),r.BMQ("aria-valuemin",0)("aria-valuenow",h.value)("aria-valuemax",100)("data-pc-name","progressbar")("data-pc-section","root"),r.R7$(),r.Y8G("ngIf","determinate"===h.mode),r.R7$(),r.Y8G("ngIf","indeterminate"===h.mode))},dependencies:[u.YU,u.bT,u.T3,u.B3],styles:['@layer primeng{.p-progressbar{position:relative;overflow:hidden}.p-progressbar-determinate .p-progressbar-value{height:100%;width:0%;position:absolute;display:none;border:0 none;display:flex;align-items:center;justify-content:center;overflow:hidden}.p-progressbar-determinate .p-progressbar-label{display:inline-flex}.p-progressbar-determinate .p-progressbar-value-animate{transition:width 1s ease-in-out}.p-progressbar-indeterminate .p-progressbar-value:before{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite;animation:p-progressbar-indeterminate-anim 2.1s cubic-bezier(.65,.815,.735,.395) infinite}.p-progressbar-indeterminate .p-progressbar-value:after{content:"";position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;animation:p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;-webkit-animation-delay:1.15s;animation-delay:1.15s}}@-webkit-keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@keyframes p-progressbar-indeterminate-anim{0%{left:-35%;right:100%}60%{left:100%;right:-90%}to{left:100%;right:-90%}}@-webkit-keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}@keyframes p-progressbar-indeterminate-anim-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}to{left:107%;right:-8%}}\n'],encapsulation:2,changeDetection:0})}return l})(),k=(()=>{class l{static \u0275fac=function(g){return new(g||l)};static \u0275mod=r.$C({type:l});static \u0275inj=r.G2t({imports:[u.MD]})}return l})()}}]);