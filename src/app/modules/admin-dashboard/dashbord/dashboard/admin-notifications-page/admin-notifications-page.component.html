<div class="container-fluid p-10">
  <!-- Header Section -->
  <div class="d-flex align-items-center justify-content-between">
    <div>
      <h1 class="text-gray-900 fw-bold fs-2x mb-2">
        <i class="ki-outline ki-notification-bing text-info fs-1 me-3"></i>
        {{lang === 'ar' ? 'الإشعارات' : 'Notifications'}}
      </h1>
      <p class="text-muted fs-6 mb-0">
        {{lang === 'ar' ? 'إدارة جميع إشعارات النظام' : 'Manage all system notifications'}}
      </p>
    </div>
    <div class="d-flex align-items-center gap-3">
      <!-- Stats -->
      <div class="d-flex align-items-center gap-4">
        <div class="text-center">
          <div class="text-info fw-bold fs-2x">{{totalCount}}</div>
          <div class="text-muted fs-7">{{lang === 'ar' ? 'الإجمالي' : 'Total'}}</div>
        </div>
        <div class="text-center">
          <div class="text-warning fw-bold fs-2x">{{unreadCount}}</div>
          <div class="text-muted fs-7">{{lang === 'ar' ? 'غير مقروء' : 'Unread'}}</div>
        </div>
      </div>
      <!-- Mark All Read Button -->
      <p-button 
        label="{{lang === 'ar' ? 'قراءة الكل' : 'Mark All Read'}}"
        icon="ki-outline ki-check-circle"
        styleClass="p-button-outlined p-button-info"
        [disabled]="unreadCount === 0"
        (onClick)="markAllAsRead()">
      </p-button>
    </div>
  </div>

  <!-- Filters Section -->
  <div class="row align-items-center">
    <div class="col-md-4">
      <label class="form-label fs-6 fw-semibold mb-2">
        {{lang === 'ar' ? 'تصفية حسب النوع' : 'Filter by Type'}}
      </label>
      <p-dropdown
        [options]="filterOptions"
        [(ngModel)]="selectedFilter"
        (onChange)="onFilterChange($event)"
        placeholder="{{lang === 'ar' ? 'اختر نوع الإشعار' : 'Select notification type'}}"
        styleClass="w-100">
      </p-dropdown>
    </div>
    <div class="col-md-8">
      <label class="form-label fs-6 fw-semibold mb-2">
        {{lang === 'ar' ? 'البحث في الإشعارات' : 'Search Notifications'}}
      </label>
      <span class="p-input-icon-left w-100">
        <i class="pi pi-search"></i>
        <input 
          type="text" 
          pInputText 
          placeholder="{{lang === 'ar' ? 'ابحث في المحتوى...' : 'Search content...'}}"
          [(ngModel)]="searchValue"
          (input)="onSearchChange()"
          class="w-100" />
      </span>
    </div>
  </div>

<div class="pt-10">
      <!-- Loading State -->
      <div *ngIf="loading" class="text-center py-12">
        <p-progressSpinner strokeWidth="3" animationDuration="1s"></p-progressSpinner>
        <p class="text-muted mt-4">{{lang === 'ar' ? 'جاري التحميل...' : 'Loading...'}}</p>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loading && filteredNotifications.length === 0" class="text-center py-12">
        <i class="ki-outline ki-notification-off text-muted" style="font-size: 4rem;"></i>
        <h4 class="text-gray-800 fw-bold mt-4">
          {{lang === 'ar' ? 'لا توجد إشعارات' : 'No Notifications Found'}}
        </h4>
        <p class="text-muted">
          {{lang === 'ar' ? 'لا توجد إشعارات تطابق المعايير المحددة' : 'No notifications match the selected criteria'}}
        </p>
      </div>

      <!-- Notifications List -->
      <div *ngIf="!loading && filteredNotifications.length > 0">
        <div 
          *ngFor="let notification of filteredNotifications; let i = index"
          class="notification-item border-bottom border-light-gray hover-bg-light-primary p-4 cursor-pointer"
          [class.bg-light-warning]="!notification.read_at"
          (click)="onNotificationClick(notification, $event)">
          
          <div class="d-flex align-items-start">
            <!-- Notification Icon -->
            <div class="flex-shrink-0 me-4">
              <div class="symbol symbol-45px">
                <div [class]="'symbol-label bg-light-' + (notification.sub_type | notificationsBg)">
                  <span
                    [inlineSVG]="'./assets/media/icons/' + (notification.sub_type | notificationsIcons)"
                    class="svg-icon fs-2"
                    [ngClass]="'svg-icon-' + (notification.sub_type | notificationsBg)">
                  </span>
                </div>
              </div>
            </div>

            <!-- Notification Content -->
            <div class="flex-grow-1">
              <div class="d-flex align-items-center justify-content-between mb-2">
                <div class="d-flex align-items-center gap-2">
                  <!-- Type Badge -->
                  <span class="badge badge-light-info fs-8">
                    {{notification.type | titlecase}}
                  </span>
                  <!-- Sub-type Badge -->
                  <span *ngIf="notification.sub_type" class="badge badge-light-secondary fs-8">
                    {{notification.sub_type | titlecase}}
                  </span>
                  <!-- Unread Indicator -->
                  <span *ngIf="!notification.read_at" class="badge badge-light-warning fs-8">
                    {{lang === 'ar' ? 'جديد' : 'New'}}
                  </span>
                </div>
                <!-- Reading Status -->
                <div class="d-flex align-items-center gap-2">
                  <small class="text-muted fs-7">
                    <span *ngIf="notification.read_at; else unreadText" class="text-success">
                      {{lang === 'ar' ? 'مقروء' : 'Read'}}
                    </span>
                    <ng-template #unreadText>
                      <span class="text-warning">
                        <i class="ki-outline ki-time fs-6 me-1"></i>
                        {{lang === 'ar' ? 'غير مقروء' : 'Unread'}}
                      </span>
                    </ng-template>
                  </small>
                </div>
              </div>

              <!-- Message -->
              <p class="text-gray-700 fs-6 mb-2" [class.fw-bold]="!notification.read_at">
                {{notification.message}}
              </p>

              <!-- Additional Info -->
              <div *ngIf="notification.param || notification.category" class="d-flex align-items-center gap-3">
                <small *ngIf="notification.category" class="text-info">
                  <i class="ki-outline ki-tag fs-7 me-1"></i>
                  {{notification.category}}
                </small>
                <small *ngIf="notification.param" class="text-muted">
                  <i class="ki-outline ki-information fs-7 me-1"></i>
                  ID: {{notification.param}}
                </small>
              </div>

              <!-- Action Buttons for Unread -->
              <div *ngIf="!notification.read_at" class="mt-3">
                <p-button
                  label="{{lang === 'ar' ? 'وضع علامة كمقروء' : 'Mark as Read'}}"
                  icon="ki-outline ki-check"
                  size="small"
                  styleClass="p-button-outlined p-button-success p-button-sm"
                  (onClick)="markAsRead(notification); $event.stopPropagation()">
                </p-button>
              </div>
            </div>

            <!-- Read Status Indicator -->
            <div class="flex-shrink-0 ms-3">
              <div *ngIf="notification.read_at; else unreadDot" class="text-success">
                <i class="ki-outline ki-check-circle fs-4"></i>
              </div>
              <ng-template #unreadDot>
                <div class="w-10px h-10px rounded-circle bg-warning"></div>
              </ng-template>
            </div>
          </div>
        </div>
      </div>
</div>
</div>