<div class="d-flex flex-column flex-root bg-light h-100vh overflow-auto" id="kt_app_root">
  <div class="d-flex flex-column flex-center min-vh-100 p-10">
    <div class="bg-body d-flex flex-column align-items-stretch flex-center rounded-4 w-md-600px p-10 shadow-sm">
      <div class="text-center mb-6">
        <h1 class="text-gray-900 fw-bolder mb-3">
          {{ lang === "ar" ? "تفعيل البريد الإلكتروني" : "Verify your email" }}
        </h1>
        <p class="text-gray-500 fw-semibold fs-6 mb-0">
          {{ lang === "ar" ? "أدخل رمز التفعيل المرسل إلى بريدك الإلكتروني لإكمال تسجيل الدخول." : "Enter the verification code sent to your email to continue." }}
        </p>
        <p class="text-gray-600 fw-semibold fs-7 mt-3" *ngIf="email">
          {{ email }}
        </p>
      </div>

      <img
        src="../../../../../assets/media/auth/verify-email.svg"
        alt="Verify Email"
        class="img-fluid my-5"
        style="max-width: 260px; margin: 0 auto;"
      />

      <form
        class="form w-100 mx-auto"
        style="max-width: 420px;"
        [formGroup]="verificationCodeForm"
        (ngSubmit)="onVerifyCodeSubmit()"
        novalidate
      >
        <div class="fv-row mb-4">
          <input
            type="text"
            inputmode="numeric"
            autocomplete="one-time-code"
            placeholder="{{ lang === 'ar' ? 'رمز التفعيل' : 'Verification code' }}"
            formControlName="code"
            class="form-control bg-transparent text-center"
            [ngClass]="{
              'is-invalid':
                verificationCodeForm.controls['code'].invalid &&
                (verificationCodeForm.controls['code'].dirty || verificationCodeForm.controls['code'].touched)
            }"
          />

          <div
            *ngIf="verificationCodeForm.controls['code'].invalid && (verificationCodeForm.controls['code'].dirty || verificationCodeForm.controls['code'].touched)"
            class="text-danger mt-2 fs-8"
          >
            <span *ngIf="verificationCodeForm.controls['code'].hasError('required')">
              {{ lang === "ar" ? "رمز التفعيل مطلوب" : "Verification code is required" }}
            </span>
            <span *ngIf="verificationCodeForm.controls['code'].hasError('pattern')">
              {{ lang === "ar" ? "رمز التفعيل غير صالح" : "Invalid verification code" }}
            </span>
          </div>
        </div>

        <div *ngIf="verifyErrorMessage" class="text-danger mb-4">
          {{ verifyErrorMessage }}
        </div>

        <div class="d-grid mb-4">
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="(isLoadingVerify$ | async) || verificationCodeForm.invalid"
          >
            <ng-container *ngIf="(isLoadingVerify$ | async) === false">
              <span class="indicator-label">
                {{ lang === "ar" ? "تفعيل" : "Verify" }}
              </span>
            </ng-container>
            <ng-container *ngIf="isLoadingVerify$ | async">
              <span class="indicator-progress" [style.display]="'block'">
                {{ lang === "ar" ? "يرجى الانتظار" : "Please wait" }}
                <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
              </span>
            </ng-container>
          </button>
        </div>
      </form>

      <p class="text-gray-500 fw-semibold fs-6 text-center mb-0">
        <span>{{ "AUTH.VERIFY_EMAIL.DIDNT_RECEIVE_EMAIL" | translate }}</span>
        <span *ngIf="isResendDisabled">
          {{ "AUTH.VERIFY_EMAIL.COUNTER" | translate }} ({{ resendCountdown$ | async }}s)
        </span>
        <a
          *ngIf="!isResendDisabled"
          (click)="onResendClick()"
          class="link-primary fw-semibold"
          [class.disabled]="isResendDisabled"
          [style.pointer-events]="isResendDisabled ? 'none' : 'auto'"
        >
          {{ "AUTH.VERIFY_EMAIL.TRY_AGAIN" | translate }}
        </a>
      </p>

      <div class="text-center mt-8">
        <button type="button" class="btn btn-sm btn-light-danger" (click)="logout()">
          {{ "AUTH.EMAIL_RECONFIRM.LOGOUT" | translate }}
        </button>
      </div>
    </div>
  </div>
</div>

