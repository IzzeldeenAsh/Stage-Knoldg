<div *ngIf="needsAgreement" class="alert alert-warning d-flex align-items-center justify-content-between" role="alert" style="border: 1px solid #ffeeba;">
  <div class="d-flex align-items-center">
    <i class="ki-duotone ki-information-2 fs-2 text-warning me-3"></i>
    <span class="fw-semibold">{{lang === 'ar' ? 'لم تقبل الاتفاقية الأخيرة' : 'You have not accepted the latest agreement.'}}</span>
  </div>
  <button class="btn btn-sm btn-warning fw-semibold" (click)="openAgreementModal()">{{lang === 'ar' ? 'مراجعة وموافقة' : 'Review & Accept'}}</button>
</div>
<app-agreement-modal
  [(visible)]="showAgreementModal"
  [agreementType]="'insighter_agreement'"
  (accepted)="onAgreementAccepted()"
  (cancelled)="onAgreementCancelled()"
></app-agreement-modal>
<app-widgets-row></app-widgets-row>
<div class="row">
    <div class="col-12 col-md-6" *ngIf="userHasStatistics"><app-knowledge-types-statistics (hasStatistics)="hasStatistics($event)"></app-knowledge-types-statistics></div>
    <div class="col-12" [ngClass]="{'col-md-12':!userHasStatistics , 'col-md-6':userHasStatistics}" *ngIf="!(isCompanyInsight | async)">
        <div class="card light-upgrade-gradient-bg h-md-100 "  style="border: 1px solid #e3f2fd">
            <div class="card-body d-flex justify-content-center flex-wrap px-xl-15 px-5">          
                <div class="flex-grow-1 mt-2 me-9 me-md-0">
                    <div class="position-relative text-gray-800 fs-1 z-index-2 fw-bold mb-5">
                        {{ 'UPGRADE_TO_COMPANY_ACCOUNT.TITLE' | translate }} 
                    </div>
        
                    <span class="text-gray-600 fw-semibold fs-6 mb-6 d-block mw-400px">
                        <ng-container *ngIf="hasPendingActivationRequest; else regularDescription">
                            {{'UPGRADE_TO_COMPANY_ACCOUNT.PENDING_DESCRIPTION' | translate}}
                        </ng-container>
                        <ng-template #regularDescription>
                            {{'UPGRADE_TO_COMPANY_ACCOUNT.DESCRIPTION' | translate}}
                        </ng-template>
                    </span>
                
                    <div class="mb-7">
                        <ng-container *ngIf="hasPendingActivationRequest; else upgradeButton">
                            <button class="btn btn-sm btn-secondary fw-semibold me-2" disabled>
                                {{'UPGRADE_TO_COMPANY_ACCOUNT.PENDING' | translate}}
                            </button>
                        </ng-container>
                        <ng-template #upgradeButton>
                            <a [routerLink]="['/app/insighter-dashboard/account-settings/company-account']" 
                               class="btn btn-sm btn-primary fw-semibold me-2">
                                {{'UPGRADE_TO_COMPANY_ACCOUNT.UPGRADE_NOW' | translate}}
                            </a>
                        </ng-template>
                    </div>
                </div>
        
                <img src="./assets/media/auth/upgrade-to-corporate.png" class="h-175px me-15" alt="Upgrade to Corporate"> 
            </div>
        </div>
    </div>
</div>

<div class="row mt-6" *ngIf="showNotificationPreferencesBanner">
  <div class="col-12">
    <div
      class="card border-0 overflow-hidden px-10"
      style="background: linear-gradient(135deg, #fff 0%, #cdffdd 100%);"
    >
      <div
        class="card-body d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-between gap-6 p-6 p-md-8"
      >
        <div [ngClass]="{ 'text-end': lang === 'ar' }">
          <div class="fw-bold fs-2 text-gray-800 mb-2">
            {{ lang === 'ar' ? 'إشعارات واتساب والرسائل النصية' : 'WhatsApp & SMS notifications' }}
          </div>
          <div class="text-gray-600 fw-semibold fs-5" style="max-width: 400px;">
            {{
              lang === 'ar'
                ? 'هل تريد استلام الإشعارات عبر واتساب والرسائل النصية؟ أضف أرقامك واختر لغة التواصل من الإعدادات الشخصية.'
                : 'Want to receive notifications by WhatsApp and SMS? Add your numbers and choose your preferred language in Personal settings.'
            }}
          </div>
          <div class="mt-5">
            <button type="button" class="btn btn-sm btn-primary fw-semibold" (click)="goToNotificationPreferences()">
              {{ lang === 'ar' ? 'تحديث التفضيلات' : 'Update preferences' }}
            </button>
          </div>
        </div>

        <img
          class="d-none d-md-block"
          [src]="notificationBannerImageUrl"
          [alt]="lang === 'ar' ? 'واتساب والرسائل النصية' : 'WhatsApp and SMS'"
          style="width: 200px; height: 200px; object-fit: contain;"
          loading="lazy"
        />
      </div>
    </div>
  </div>
</div>
